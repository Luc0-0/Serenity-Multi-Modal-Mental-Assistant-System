/* Serenity Check-In Module */

:root {
  --orb-size: min(560px, 82vmin);
  --glow-amber: #e8a84a;
  --glow-warm: #f5c87a;
  --glow-dim: rgba(200, 148, 72, 0.18);
  --text-white: #ffffff;
  --text-cream: rgba(255, 248, 235, 0.92);
  --text-muted: rgba(255, 240, 210, 0.55);
}

/* Main Container - Relies on inline style for margin-left transition */
.container {
  position: relative;
  width: 100%;
  height: calc(100vh - 60px); /* Adjust based on navbar height */
  overflow: hidden;
  display: flex;
  flex-direction: column;
  z-index: 1;
  overscroll-behavior-x: none;
  transition:
    margin-left 0.6s cubic-bezier(0.22, 1, 0.36, 1),
    width 0.6s cubic-bezier(0.22, 1, 0.36, 1);
}

.container.chatMode {
  overflow: hidden;
}

/* Background - Fixed to viewport to prevent sliding with content */
.backgroundImage {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url("/images/checkinpagebg.png");
  background-color: #0d0a08;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  z-index: 0;
}

/* Darkening overlay */
.backgroundImage::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    radial-gradient(
      ellipse 80% 70% at 50% 50%,
      rgba(0, 0, 0, 0) 0%,
      rgba(0, 0, 0, 0.08) 50%,
      rgba(0, 0, 0, 0.42) 100%
    ),
    linear-gradient(
      to bottom,
      rgba(4, 3, 2, 0.3) 0%,
      rgba(4, 3, 2, 0.05) 25%,
      rgba(4, 3, 2, 0.05) 60%,
      rgba(4, 3, 2, 0.5) 100%
    );
  z-index: 1;
}

/* Noise texture */
.backgroundImage::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  background-size: 180px 180px;
  opacity: 0.28;
  z-index: 2;
  pointer-events: none;
}

/* Welcome Screen Content */
.content {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 5;
  overflow: hidden;
}

/* Orb Animation Components */
.orbContainer {
  position: relative;
  width: var(--orb-size);
  height: var(--orb-size);
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeInScale 1.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  opacity: 0;
}

.orbContainer::before {
  content: "";
  position: absolute;
  inset: -30px;
  border-radius: 50%;
  background: radial-gradient(
    circle,
    rgba(220, 170, 90, 0.06) 40%,
    rgba(200, 148, 72, 0.03) 60%,
    transparent 72%
  );
  animation: orbPulse 6s ease-in-out infinite;
  pointer-events: none;
  z-index: 0;
}

.orbRing {
  position: absolute;
  inset: -1px;
  border-radius: 50%;
  background: conic-gradient(
    from 0deg,
    transparent 0deg,
    rgba(180, 130, 60, 0.06) 30deg,
    rgba(220, 175, 100, 0.35) 55deg,
    rgba(245, 215, 150, 0.75) 72deg,
    rgba(255, 235, 180, 1) 82deg,
    rgba(245, 215, 150, 0.75) 92deg,
    rgba(220, 175, 100, 0.35) 108deg,
    rgba(180, 130, 60, 0.08) 135deg,
    transparent 170deg,
    transparent 360deg
  );
  animation: orbSpin 10s linear infinite;
  -webkit-mask: radial-gradient(
    farthest-side,
    transparent calc(100% - 1.5px),
    #fff calc(100% - 1.5px)
  );
  mask: radial-gradient(
    farthest-side,
    transparent calc(100% - 1.5px),
    #fff calc(100% - 1.5px)
  );
  z-index: 3;
  filter: drop-shadow(0 0 8px rgba(245, 210, 140, 0.4))
    drop-shadow(0 0 20px rgba(220, 170, 90, 0.2));
}

.orbRingBase {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 1px solid rgba(200, 148, 72, 0.14);
  z-index: 2;
}

.orb {
  position: relative;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: radial-gradient(
    ellipse at 50% 42%,
    rgba(255, 255, 255, 0.06) 0%,
    rgba(255, 255, 255, 0.03) 50%,
    rgba(0, 0, 0, 0.04) 100%
  );
  backdrop-filter: blur(2px) saturate(1.05);
  -webkit-backdrop-filter: blur(2px) saturate(1.05);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 12% 10%;
  z-index: 4;
}

@keyframes orbSpin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
@keyframes orbPulse {
  0%,
  100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 1.3;
    transform: scale(1.02);
  }
}
@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.92);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.orbContent {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  width: 100%;
  gap: 0;
}

.welcomeHeading {
  font-family: "Playfair Display", serif;
  font-size: clamp(2.6rem, 5vw, 4.2rem);
  font-weight: 400;
  color: rgba(35, 28, 22, 0.88);
  margin: 0 0 16px 0;
  line-height: 1.08;
  letter-spacing: 0.02em;
  text-shadow:
    0 1px 8px rgba(255, 255, 255, 0.3),
    0 0 30px rgba(255, 255, 255, 0.1);
  animation: fadeInUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.35s forwards;
  opacity: 0;
}

.subtitle {
  font-family: "Libre Baskerville", serif;
  font-size: clamp(15px, 1.7vw, 17px);
  font-style: italic;
  font-weight: 400;
  color: rgba(35, 28, 22, 0.78);
  margin: 0 0 28px 0;
  letter-spacing: 0.08em;
  max-width: 100%;
  text-shadow:
    0 1px 8px rgba(255, 255, 255, 0.3),
    0 0 30px rgba(255, 255, 255, 0.1);
  animation: fadeInUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.5s forwards;
  opacity: 0;
}

.orbDivider {
  width: 1px;
  height: 28px;
  background: linear-gradient(
    to bottom,
    transparent,
    rgba(120, 90, 50, 0.35),
    transparent
  );
  margin: 0 auto 28px;
  animation: fadeInUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.55s forwards;
  opacity: 0;
}

/* Input Elements */
.inputWrapper {
  width: 100%;
  max-width: 320px;
  margin: 0 auto 28px;
  position: relative;
  animation: fadeInUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.6s forwards;
  opacity: 0;
}

.inputContainer {
  position: relative;
  display: flex;
  align-items: center;
  border-bottom: 1.5px solid rgba(35, 28, 22, 0.3);
  transition: border-color 0.4s ease;
}

.inputContainer::after {
  content: "";
  position: absolute;
  bottom: -1px;
  left: 0;
  width: 100%;
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent 0%,
    transparent 38%,
    rgba(35, 28, 22, 0.65) 50%,
    transparent 62%,
    transparent 100%
  );
  background-size: 200% 100%;
  animation: cursorPulse 3s ease-in-out infinite;
}

@keyframes cursorPulse {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.inputContainer:focus-within {
  border-bottom-color: rgba(35, 28, 22, 0.5);
}

.minimalInput {
  width: 100%;
  background: transparent;
  border: none;
  padding: 14px 28px 14px 0;
  font-family: "Libre Baskerville", serif;
  font-size: 1.15rem;
  font-style: italic;
  font-weight: 400;
  color: rgba(35, 28, 22, 0.78);
  text-align: center;
  text-shadow:
    0 1px 8px rgba(255, 255, 255, 0.3),
    0 0 20px rgba(255, 255, 255, 0.1);
  outline: none;
  letter-spacing: 0.04em;
  caret-color: rgba(35, 28, 22, 0.6);
}

.minimalInput::placeholder {
  color: rgba(35, 28, 22, 0.42);
  font-weight: 400;
  text-shadow: 0 1px 6px rgba(255, 255, 255, 0.25);
}

.submitArrow {
  position: absolute;
  right: 2px;
  background: none;
  border: none;
  color: rgba(120, 85, 40, 0.5);
  font-size: 16px;
  cursor: pointer;
  padding: 0;
  display: flex;
  align-items: center;
  transition: all 0.3s ease;
  opacity: 0;
  pointer-events: none;
}

.inputContainer:focus-within .submitArrow {
  opacity: 1;
  pointer-events: auto;
}
.submitArrow:hover:not(:disabled) {
  color: rgba(160, 120, 50, 0.9);
  transform: translateX(3px);
}
.submitArrow:disabled {
  opacity: 0 !important;
  pointer-events: none;
}

.actionButtons {
  display: flex;
  gap: 44px;
  justify-content: center;
  align-items: center;
  animation: fadeInUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.72s forwards;
  opacity: 0;
}

.actionBtn {
  position: relative;
  padding: 0;
  background: none;
  border: none;
  color: rgba(35, 28, 22, 0.7);
  font-family: "Libre Baskerville", serif;
  font-size: 12px;
  font-weight: 400;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  cursor: pointer;
  transition: color 0.35s ease;
  text-shadow: 0 1px 6px rgba(255, 255, 255, 0.25);
}

.actionBtn::after {
  content: "";
  position: absolute;
  bottom: -5px;
  left: 10%;
  width: 80%;
  height: 1px;
  background: rgba(35, 28, 22, 0.25);
}

.actionBtn:hover::after {
  background: rgba(35, 28, 22, 0.5);
}
.actionBtn:active {
  transform: scale(0.97);
}

.footer {
  position: relative;
  z-index: 5;
  padding: 20px 48px;
  text-align: center;
}

.disclaimer {
  font-family: "Cormorant Garamond", serif;
  font-size: 10px;
  color: rgba(255, 255, 255, 0.2);
  letter-spacing: 0.1em;
  text-transform: uppercase;
  margin: 0;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8);
}

/* Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(14px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(28px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}
@keyframes messageSlideIn {
  from {
    opacity: 0;
    transform: translateY(7px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Chat Mode Layout */
.chatContentWrapper {
  flex: 1;
  display: flex;
  overflow: hidden;
  position: relative;
  z-index: 5;
  height: 100%;
  overscroll-behavior-x: none;
}

.messagesArea {
  flex: 1;
  overflow-y: auto;
  overscroll-behavior: none;
  padding: 32px 52px 160px 52px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  height: 100%;
  width: 100%;
  min-width: 0;
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
  -webkit-mask-image: linear-gradient(
    to bottom,
    transparent 0%,
    black 5%,
    black 88%,
    transparent 100%
  );
  mask-image: linear-gradient(
    to bottom,
    transparent 0%,
    black 5%,
    black 88%,
    transparent 100%
  );
}

.insightsPanel {
  width: 300px;
  min-width: 300px;
  height: 100%;
  overflow-y: auto;
  padding: 24px 16px 140px;
  background: rgba(0, 0, 0, 0.18);
  backdrop-filter: blur(20px) saturate(1.15);
  -webkit-backdrop-filter: blur(20px) saturate(1.15);
  border-left: 1px solid rgba(255, 255, 255, 0.05);
}

.message {
  display: flex;
  animation: messageSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  opacity: 0;
  width: 100%;
}
.message.user {
  justify-content: flex-end;
}
.message.assistant {
  justify-content: flex-start;
}

.messageBubble {
  max-width: 65%;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.messageContent {
  padding: 14px 20px;
  line-height: 1.85;
  word-wrap: break-word;
}

.message.user .messageContent {
  background: rgba(0, 0, 0, 0.28);
  border: 1px solid rgba(255, 255, 255, 0.06);
  color: rgba(255, 250, 240, 0.92);
  border-radius: 16px 16px 4px 16px;
  backdrop-filter: blur(24px) saturate(1.2);
  -webkit-backdrop-filter: blur(24px) saturate(1.2);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
  font-family: "Inter", sans-serif;
  font-size: 14px;
  font-weight: 400;
  line-height: 1.75;
}

.message.assistant .messageContent {
  background: rgba(0, 0, 0, 0.22);
  border: 1px solid rgba(255, 255, 255, 0.05);
  color: rgba(255, 245, 230, 0.9);
  border-radius: 16px 16px 16px 4px;
  backdrop-filter: blur(24px) saturate(1.15);
  -webkit-backdrop-filter: blur(24px) saturate(1.15);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
  font-family: "Cormorant Garamond", serif;
  font-size: 1.25rem;
  font-weight: 400;
  font-style: italic;
  line-height: 1.9;
}

.messageTime {
  font-size: 11px;
  color: rgba(255, 245, 230, 0.45);
  font-family: "Inter", sans-serif;
  padding: 2px 4px;
  letter-spacing: 0.03em;
}

.message.user .messageTime {
  text-align: right;
}
.message.assistant .messageTime {
  text-align: left;
}

.typingIndicator {
  display: flex;
  gap: 4px;
  align-items: center;
  padding: 3px 0;
}
.typingIndicator span {
  display: inline-block;
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: rgba(196, 168, 130, 0.5);
  animation: typingBounce 1.5s infinite;
}
.typingIndicator span:nth-child(2) {
  animation-delay: 0.2s;
}
.typingIndicator span:nth-child(3) {
  animation-delay: 0.4s;
}
@keyframes typingBounce {
  0%,
  60%,
  100% {
    transform: translateY(0);
    opacity: 0.3;
  }
  30% {
    transform: translateY(-4px);
    opacity: 0.9;
  }
}

/* Chat Input - Absolute position to allow movement with container */
.chatInputArea {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 16px 48px 24px;
  background: linear-gradient(
    to top,
    rgba(3, 2, 1, 0.97) 0%,
    rgba(3, 2, 1, 0.88) 30%,
    rgba(3, 2, 1, 0.6) 58%,
    rgba(3, 2, 1, 0) 100%
  );
  z-index: 20;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  pointer-events: none;
}

.chatInputContainer {
  pointer-events: auto;
  display: flex;
  align-items: center;
  width: 100%;
  max-width: 700px;
  gap: 8px;
  background: rgba(10, 7, 4, 0.72);
  border: 1px solid rgba(196, 168, 130, 0.12);
  border-radius: 14px;
  padding: 5px 5px 5px 20px;
  backdrop-filter: blur(32px) saturate(1.3);
  -webkit-backdrop-filter: blur(32px) saturate(1.3);
  box-shadow:
    0 8px 40px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.03);
  transition: all 0.38s cubic-bezier(0.16, 1, 0.3, 1);
}

.chatInputContainer:focus-within {
  background: rgba(14, 10, 6, 0.82);
  border-color: rgba(196, 168, 130, 0.25);
  box-shadow:
    0 12px 48px rgba(0, 0, 0, 0.48),
    0 0 0 1px rgba(196, 168, 130, 0.06),
    inset 0 1px 0 rgba(255, 255, 255, 0.04);
  transform: translateY(-2px);
}

.chatInput {
  flex: 1;
  padding: 11px 0;
  background: transparent;
  border: none;
  color: #e8dece;
  font-family: "Libre Baskerville", serif;
  font-size: 14.5px;
  letter-spacing: 0.01em;
  outline: none;
  line-height: 1.5;
}
.chatInput::placeholder {
  color: rgba(196, 168, 130, 0.28);
  font-style: italic;
}

.chatSubmitBtn,
.homeBtn {
  width: 36px;
  height: 36px;
  min-width: 36px;
  border-radius: 10px;
  background: rgba(196, 168, 130, 0.09);
  border: 1px solid rgba(196, 168, 130, 0.12);
  color: rgba(212, 192, 162, 0.6);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.25s cubic-bezier(0.16, 1, 0.3, 1);
  flex-shrink: 0;
}
.chatSubmitBtn:hover:not(:disabled),
.homeBtn:hover {
  background: rgba(196, 168, 130, 0.18);
  border-color: rgba(196, 168, 130, 0.28);
  color: #ede4d3;
  transform: translateY(-1px);
}
.chatSubmitBtn:active:not(:disabled),
.homeBtn:active {
  transform: scale(0.93);
}
.chatSubmitBtn:disabled {
  opacity: 0.15;
  cursor: default;
}

/* Insights Edge Tab - Absolute position to allow movement with container */
.insightsEdgeTab {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(10, 8, 5, 0.85);
  border: 1px solid rgba(196, 168, 130, 0.12);
  border-right: none;
  border-radius: 8px 0 0 8px;
  color: rgba(196, 168, 130, 0.55);
  padding: 14px 7px;
  cursor: pointer;
  z-index: 15;
  transition: all 0.38s cubic-bezier(0.16, 1, 0.3, 1);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  box-shadow: -2px 0 16px rgba(0, 0, 0, 0.28);
  display: flex;
  align-items: center;
  justify-content: center;
}

.insightsEdgeTab:hover {
  padding-left: 12px;
  background: rgba(196, 168, 130, 0.06);
  color: rgba(220, 196, 158, 0.9);
}

.insightsEdgeTab.insightsTabOpen {
  right: 300px;
}

/* Error States */
.errorMessage {
  padding: 12px 16px;
  margin: 6px 0;
  background: rgba(80, 20, 20, 0.55);
  border: 1px solid rgba(180, 90, 90, 0.2);
  border-radius: 10px;
  backdrop-filter: blur(12px);
  animation: messageSlideIn 0.35s cubic-bezier(0.16, 1, 0.3, 1);
}
.errorContent {
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.errorText {
  font-family: "Cormorant Garamond", serif;
  font-size: 15px;
  color: rgba(230, 170, 170, 0.9);
  margin: 0;
  line-height: 1.55;
  font-style: italic;
}
.errorActions {
  display: flex;
  gap: 8px;
}
.retryBtn,
.dismissBtn {
  padding: 5px 14px;
  border: 1px solid rgba(180, 90, 90, 0.22);
  border-radius: 5px;
  background: transparent;
  color: rgba(230, 170, 170, 0.8);
  font-family: "Cormorant Garamond", serif;
  font-size: 13px;
  letter-spacing: 0.05em;
  cursor: pointer;
  transition: all 0.25s ease;
}
.retryBtn:hover {
  background: rgba(180, 90, 90, 0.1);
  border-color: rgba(180, 90, 90, 0.4);
  color: #ede4d3;
}
.dismissBtn {
  color: rgba(196, 168, 130, 0.55);
  border-color: rgba(196, 168, 130, 0.14);
}
.dismissBtn:hover {
  background: rgba(196, 168, 130, 0.06);
  border-color: rgba(196, 168, 130, 0.28);
  color: rgba(212, 192, 162, 0.85);
}

/* Empty State */
.emptyState {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 60px 20px;
}
.emptyState p {
  font-family: "Libre Baskerville", serif;
  font-size: 15px;
  font-style: italic;
  color: rgba(196, 168, 130, 0.3);
  text-align: center;
  line-height: 1.7;
}

/* Custom Scrollbar */
.messagesArea::-webkit-scrollbar {
  width: 3px;
}
.messagesArea::-webkit-scrollbar-track {
  background: transparent;
}
.messagesArea::-webkit-scrollbar-thumb {
  background: rgba(196, 168, 130, 0.1);
  border-radius: 3px;
}
.messagesArea::-webkit-scrollbar-thumb:hover {
  background: rgba(196, 168, 130, 0.22);
}

/* Responsive */
@media (max-width: 1200px) {
  .messagesArea {
    padding: 28px 40px 160px 40px;
  }
}

@media (max-width: 1024px) {
  .insightsPanel {
    width: 268px;
    min-width: 268px;
  }
  .insightsEdgeTab.insightsTabOpen {
    right: 268px;
  }
  .messagesArea {
    padding: 24px 32px 160px 32px;
  }
}

@media (max-width: 768px) {
  :root {
    --orb-size: min(88vw, 88vh);
  }
  .chatContentWrapper {
    flex-direction: column;
  }
  .insightsPanel {
    position: fixed !important;
    bottom: 70px;
    right: 0;
    left: 0;
    width: 100% !important;
    max-height: 45vh;
    overflow-y: auto;
    z-index: 200;
    border-radius: 20px 20px 0 0;
    background: rgba(8, 8, 12, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(212, 175, 55, 0.2);
    border-left: none;
    padding: 1rem;
    transform: translateY(0);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .insightsEdgeTab {
    position: fixed !important;
    bottom: 80px;
    right: 1rem;
    top: auto !important;
    z-index: 201;
    background: rgba(212, 175, 55, 0.15);
    border: 1px solid rgba(212, 175, 55, 0.3);
    border-radius: 50%;
    width: 40px;
    height: 40px;
  }
  .insightsEdgeTab.insightsTabOpen {
    right: 1rem;
    bottom: 80px;
  }
  .messagesArea {
    padding: 18px 18px 160px 18px;
  }
  .chatInputArea {
    padding: 12px 12px 18px;
  }
  .chatInputContainer {
    max-width: 100%;
  }
  .messageBubble {
    max-width: 82%;
  }
  .messageContent {
    font-size: 14px;
  }
  .footer {
    padding: 18px 24px;
  }
  .welcomeHeading {
    font-size: 2.4rem;
  }
  .subtitle {
    font-size: 15px;
  }
  .actionButtons {
    gap: 36px;
  }
}
